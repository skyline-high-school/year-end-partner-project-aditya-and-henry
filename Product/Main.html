<!DOCTYPE html>
<html>
  <title>Finance Buddy</title>
  <link rel="stylesheet" href="styles1.css">

  <script>
    function fetchBitcoin() { //function to get the live Bitcoin price from API
        fetch('https://api.coindesk.com/v1/bpi/currentprice/BTC.json')
        .then(response => response.json())
        .then(data => displayCrypto('Bitcoin', data.bpi.USD.rate, 'USD'))
        .catch(error => console.error('Error fetching Bitcoin data:', error));
    }
    function fetchEthereum() { //function to get the live Etheruem price from API
        fetch('https://min-api.cryptocompare.com/data/price?fsym=ETH&tsyms=USD')
        .then(response => response.json())
        .then(data => displayCrypto('Ethereum', data.USD, 'USD'))
        .catch(error => console.error('Error fetching Ethereum data:', error));
    }
    function fetchLitecoin() { //function to get the live Litecoin price from API
        fetch('https://min-api.cryptocompare.com/data/price?fsym=LTC&tsyms=USD')
        .then(response => response.json())
        .then(data => displayCrypto('Litecoin', data.USD, 'USD'))
        .catch(error => console.error('Error fetching Litecoin data:', error));
    }  
    function fetchDogecoin() { //function to get the live Dodgecoin price from API
        fetch('https://min-api.cryptocompare.com/data/price?fsym=DOGE&tsyms=USD')
        .then(response => response.json())
        .then(data => displayCrypto('Dogecoin', data.USD, 'USD'))
        .catch(error => console.error('Error fetching Dogecoin data:', error));
    }
    function fetchQTUM() { //function to get the live QTUM price from API
        fetch('https://min-api.cryptocompare.com/data/price?fsym=QTUM&tsyms=USD')
        .then(response => response.json())
        .then(data => displayCrypto('Qtum', data.USD, 'USD'))
        .catch(error => console.error('Error fetching Qtum data:', error));
    }
    function fetchZcash() { //function to get the live Zcash price from API
        fetch('https://min-api.cryptocompare.com/data/price?fsym=ZEC&tsyms=USD')
        .then(response => response.json())
        .then(data => displayCrypto('Zcash', data.USD, 'USD'))
        .catch(error => console.error('Error fetching Zcash data:', error));
    }

    function displayCrypto(cryptoName, rate, currency) { //function tp show and format the price of each crypto
      var resultsContainer = document.getElementById('results');
      resultsContainer.innerHTML = '';
      var output = `1 ${cryptoName} is $${rate} ${currency} right now`;
      resultsContainer.innerHTML = `<div class = "resultscard"><h3>${cryptoName}</h3><p>${output}</p><div>`;
    }

    function fetchCurrencyRate(){ //call to API to get live currency updates
      fetch('https://api.exchangerate-api.com/v4/latest/USD')
      .then(response => response.json())
      .then(data => updateMarquee(data.rates))
      .catch(error => console.error('Unfortunatley, there was an error fetching currency rates:', error));
    }

    function updateMarquee(rates) { //update the marquee with the new prices
       var marquee = document.getElementById('marquee');
       var marqueeContent = 'Live Exchange Rates:   ';
       for (var currency in rates) {
            if (rates.hasOwnProperty(currency)) {
                marqueeContent += ` ${currency}: ${rates[currency]}`;
                marqueeContent += '\xa0\xa0\xa0'; //to add spaces between values
            }
        }
        marquee.textContent = marqueeContent;
    }

    window.onload = function() { //when you reload the window, refreshes the rates
      fetchCurrencyRate();
    }

    const taxBrackets = [ //similar to a java Class Constant, and in this case it is an array of tax rates and ranges
          { rate: 0.10, range: [0, 9950] },
          { rate: 0.12, range: [9951, 40525] },
          { rate: 0.22, range: [40526, 86375] },
          { rate: 0.24, range: [86376, 164925] },
          { rate: 0.32, range: [164926, 209425] },
          { rate: 0.35, range: [209426, 523600] },
          { rate: 0.37, range: [523601, Infinity] }
    ];

    function displayTaxBrackets() { //function to show the tax bracket ranges using the previous const
      const taxBracketsList = document.getElementById('taxBrackets')
      taxBracketsList.innerHTML = ' ';
      taxBrackets.forEach(bracket => {
          const li = document.createElement('li');
          //income range placeholders that are shown from the index of the array
          li.textContent = `Income from $${bracket.range[0]} to $${bracket.range[1] === Infinity ? 'âˆž' : bracket.range[1]}: ${bracket.rate * 100}%`
          taxBracketsList.appendChild(li);
      });
    }
    function calculateTax() { //function to find the tax rates for the inputted income
      const income = parseFloat(document.getElementById('incomeInput').value);
      if (isNaN(income) || income < 0) {
        alert('Please enter a valid income!!!!'); //error handling an incorrect input type
        return;
      }
      
      let tax = 0;
      let previousRangesEnd = 0;
      for(const bracket of taxBrackets) {
        if (income > bracket.range[0]) {
          const taxableIncome = Math.min(income, bracket.range[1]) - previousRangesEnd;
          tax += taxableIncome * bracket.rate;
          previousRangesEnd = bracket.range[1];
          if (income <= bracket.range[1]) break; //the way taxes work in the US is that if you make 50,000 a year, the first 9950 will be charged at 10%, the next 29000 at 12%, etc. So it is a different calculation rather than just taking 22% of 50,000 USD.
        }
      }
      const taxResult = document.getElementById('taxResult');
      taxResult.innerHTML = `<p>Your calculated tax is $${tax.toFixed(2)}</p>`;
      taxResult.style.display = 'block';
    }

    function calculateSavings() { //function to calculate savings
      const monthlyIncome = parseFloat(document.getElementById('monthlyIncomeInput').value);
      if (isNaN(monthlyIncome) || monthlyIncome < 0) {
          alert('Please enter a valid monthly income!!'); //error handling invalid inputs
          return;
      }
     
      const retirementPercentage = 0.15; // 15% for retirement
      const emergencyPercentage = 0.30; // 10% for emergency savings
      const rentPercentage = 0.30; // 30% for rent and utilites

      const retirementSavings = monthlyIncome * retirementPercentage;
      const emergencySavings = monthlyIncome * emergencyPercentage;
      const rentSavings = monthlyIncome * emergencyPercentage;
      const monthlySpending = (monthlyIncome - retirementSavings - emergencySavings - rentSavings);

      const savingsResultContainer = document.getElementById('savingsResult');
      savingsResultContainer.innerHTML = 
         `<p>Retirement Savings: $${retirementSavings.toFixed(2)}</p>
          <p>Emergency Savings: $${emergencySavings.toFixed(2)}</p>
          <p>Rent/Utilites Savings: $${rentSavings.toFixed(2)}</p>
          <p>Monthly Spending: $${monthlySpending.toFixed(2)}</p>`;
      savingsResultContainer.style.display = 'block';
    } 

    window.onload = function() { //when you reload, refresh the rates and clear the tax value
        fetchCurrencyRate();
        displayTaxBrackets();
    }

  </script>
  



</head>
<body>
    <div class="container">
        <img class="irs-logo" src="IRSLogo.png" alt="IRS Logo">
        <div class="header">
            <h1>Welcome to Finance Buddy</h1>
        </div>
    </div>
    <div class="links">
        <ul>
            <li style="font-size: 22px; color: brown; font-family: 'Times New Roman', Times, serif;">Helpful Links:</li>
            <li><a href="https://irs.gov" target="_blank">IRS</a></li>
            <li><a href="https://treasury.gov" target="_blank">U.S. Treasury</a></li>
            <li><a href="https://bofa.com" target="_blank">Bank of America</a></li>
            <li><a href="https://chase.com" target="_blank">Chase Bank</a></li>
            <li><a href="https://JPmorgan.com" target="_blank">JP Morgan Investment Bank</a></li>
            <li><a href="https://key.com" target="_blank">Key Bank</a></li>
            <li><a href="https://bannerbank.com" target="_blank">Banner Bank</a></li>
            <li><a href="https://becu.com" target="_blank">BECU Bank</a></li>

        </ul>
    </div>
    <div class="marquee-container">
      <div id="marquee" class="marquee"></div>
  </div>
  <div class="mainContainer">
      <h2 id="sectionLabel">Cryptocurrency Assistant</h2>
      <div class="button-row">
        <button onclick="fetchBitcoin()">Bitcoin</button>
        <button onclick="fetchEthereum()">Ethereum</button>
        <button onclick="fetchDogecoin()">Dogecoin</button>
        <button onclick="fetchZcash()">Zcash</button>
        <button onclick="fetchQTUM()">QTUM</button>
    </div>
    <div id="results" class="resultscontainer"></div>
  </div>
      

    <div class="tax-assistant">
      <div class="mainContainer">
        <div class="taxBracketsList">
            <h2 id="sectionLabel">Federal Tax Brackets (2024)</h2>
            <ul id="taxBrackets"></ul>
        </div>
        <div class="searchContainer">
              <input type="text" id="incomeInput" placeholder="Enter your yearly income (without '$')">
              <button onclick="calculateTax()">Calculate Tax</button>
        </div>
        <div id="taxResult" class="resultscard" style="display: none;"></div>
      </div>
    </div>

    <div class="mainContainer">
      <h2>Monthly Savings and Spending Calculator</h2>
      <div class="searchContainer">
          <input type="text" id="monthlyIncomeInput" placeholder="Enter your monthly income (without '$'')">
          <button onclick="calculateSavings()">Calculate Savings</button>
      </div>
      <div id="savingsResult" class="resultscard" style="display: none;"></div>
  </div>
  
</html>



